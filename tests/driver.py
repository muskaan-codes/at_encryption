"""
-*- coding: utf-8 -*-
Implementation of the Driver Code + a some logging for debugging for Encryption Util
Created: April 2023
Owners: Project 4a: Muskaan Manocha, Prem Desai, Yeshaswini Murthy
"""

import sys
import os

# getting the name of the directory
# where the this file is present.
current = os.path.dirname(os.path.realpath(__file__))
 
# Getting the parent directory name
# where the current directory is present.
parent = os.path.dirname(current)
 
# adding the parent directory to
# the sys.path.
sys.path.append(parent)
 
# now we can import the module in the parent
# directory.
from encryption_util import *


util = EncryptionUtil()

def rsaEncryptDecryptString(plaintext = "Hello World!!! 1234"):
    util.generate_rsa_key_pair()
    print(len(util.rsa_keypair))
    print("keypair after generation is:")
    print(util.rsa_keypair)
    pubkey = util.public_key_from_base64()
    privkey = util.private_key_from_base64()
    print("Original text: %s, encrypting using pubkey:" % plaintext)
    print(pubkey)
    print(type(pubkey))
    encrypted = util.rsa_encrypt_to_base64(plaintext, pubkey)
    print("Encrypted text: %s, decrypting using" % encrypted)
    print(privkey)
    print(type(privkey))
    print(str(type(privkey))=="<class 'rsa.key.PrivateKey'>")
    decrypted = util.rsa_decrypt_from_base64(encrypted, privkey)
    print("Decrypted text: %s" % decrypted)
    print(plaintext==decrypted)

def aesEncryptDecryptString(plaintext = "Hello World!!! 1234"):
    key = util.generate_aes_key_base64()
    print("keypair after generation is:")
    print(key)
    print("Original text: %s, encrypting using key:" % plaintext)
    print(key)
    print(type(key))
    encrypted = util.aes_encrypt(plaintext, key)
    print("Decrypting..." + encrypted)
    decrypted = util.aes_decrypt(encrypted, key)
    print("Comparing decrypted text %s with original %s", (decrypted, plaintext))
    print(plaintext == decrypted)

rsaEncryptDecryptString()
aesEncryptDecryptString()


"""
OP:
cd /Users/muskaanmanocha/workspace/682/atPlatform_Python_Client_SDK ; /usr/bin/env /Users/muskaanmanocha/opt/anaconda3/bin/python /Users/muskaanmanocha/.vscode/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 51998 -- /Users/muskaanmanocha/workspace/682/atPlatform_Python_Client_SDK/main/api/proj_4a/tests_proj_4a/driver.py 
2
keypair after generation is:
(PublicKey(18963069812295956587337924052134540950193473847529961618692539108750646095769505992462541046616671742024095066246075721309856239739785919252326844829653260978819225486831118141084053620106224851516960823490972406810855832924802323672787382669365281799039368131157528575504655121216997986086550860754392267899871779873066699844281092607075206811241248795090134336452289919466540735872504732756410605004689844270682786811233914285619938711342877634397092613262175709694547715375971669211618354564009507842596895838474747241523608102618230710993384145892461721031197054720659665069659912276441952145075014608158460929727, 65537), PrivateKey(18963069812295956587337924052134540950193473847529961618692539108750646095769505992462541046616671742024095066246075721309856239739785919252326844829653260978819225486831118141084053620106224851516960823490972406810855832924802323672787382669365281799039368131157528575504655121216997986086550860754392267899871779873066699844281092607075206811241248795090134336452289919466540735872504732756410605004689844270682786811233914285619938711342877634397092613262175709694547715375971669211618354564009507842596895838474747241523608102618230710993384145892461721031197054720659665069659912276441952145075014608158460929727, 65537, 3567095299540481755477088174843441427498743390639629016208273526903550133033957457239089461261429867642294337193976249939849363314037578963679834949112187029416717454287715709344098952174642415269253902863980771642953304366952455044297463319162231930337936285165784400854805504285566186618887779974689192039111274636467525450966045748575527886486981103924856977455821723587284416914576638914692091287071998463297215907320648281739870294244243528569385902403743168019632862610613233139957587934170626962114664998290216353448274022840073805902237633802083742336060195288413552324778518119906567463425026891059717001537, 2672824073567675211095367977368110009754064334961148682594496774266856158415604899612305239374432800274125601653785856471398484763630184588497419516443290564819626752370869237593598293529537425929111103703070352769137290035226767327130019248873001437909510245165206396554304007377504259274617269043494921634681250618035022890323, 7094769161886560128153658726964766978752808729976992983259376954042337332017099148318237891368060777558447206427410874586239069373289275272373909442819751045858934796553984793113337147103762753788500061169797977057353150687738596582800167831737578190483124898722767706168748792250249109349))
Original text: Hello World!!! 1234, encrypting using pubkey:
PublicKey(18963069812295956587337924052134540950193473847529961618692539108750646095769505992462541046616671742024095066246075721309856239739785919252326844829653260978819225486831118141084053620106224851516960823490972406810855832924802323672787382669365281799039368131157528575504655121216997986086550860754392267899871779873066699844281092607075206811241248795090134336452289919466540735872504732756410605004689844270682786811233914285619938711342877634397092613262175709694547715375971669211618354564009507842596895838474747241523608102618230710993384145892461721031197054720659665069659912276441952145075014608158460929727, 65537)
<class 'rsa.key.PublicKey'>
Encrypted text: b'EUbNm//5EcX2Pl+AeFkOw1ElzRqkysYsFE8YBgLhju092g28Q27NS5yU+d+YWybsFvOFbugOm68nXOUyY7t5Pfw/1PAzpB03Uoj8m2BenAWUqSW2SDUlnX1ywQyL3UFsxSycmmHpUGuGfjzoMD26cS40EtOlBG8bI+ARgk+YkAlKQNx0484Q+n6PAnCCXpLTGTtC7A1GLSxubfVUBIUldGjp9zV+T55MSeVYEVx8mzIewCiu2paXPok9iWIN4IUDVy74VgRyKd0FTkEfNTufH9QSNw0YNQGOAMgTPZNEbgbrhD5wpRpNSaaB3u4uLD1MGLj9NvGgEoclTug+QxfXXA==', decrypting using
PrivateKey(18963069812295956587337924052134540950193473847529961618692539108750646095769505992462541046616671742024095066246075721309856239739785919252326844829653260978819225486831118141084053620106224851516960823490972406810855832924802323672787382669365281799039368131157528575504655121216997986086550860754392267899871779873066699844281092607075206811241248795090134336452289919466540735872504732756410605004689844270682786811233914285619938711342877634397092613262175709694547715375971669211618354564009507842596895838474747241523608102618230710993384145892461721031197054720659665069659912276441952145075014608158460929727, 65537, 3567095299540481755477088174843441427498743390639629016208273526903550133033957457239089461261429867642294337193976249939849363314037578963679834949112187029416717454287715709344098952174642415269253902863980771642953304366952455044297463319162231930337936285165784400854805504285566186618887779974689192039111274636467525450966045748575527886486981103924856977455821723587284416914576638914692091287071998463297215907320648281739870294244243528569385902403743168019632862610613233139957587934170626962114664998290216353448274022840073805902237633802083742336060195288413552324778518119906567463425026891059717001537, 2672824073567675211095367977368110009754064334961148682594496774266856158415604899612305239374432800274125601653785856471398484763630184588497419516443290564819626752370869237593598293529537425929111103703070352769137290035226767327130019248873001437909510245165206396554304007377504259274617269043494921634681250618035022890323, 7094769161886560128153658726964766978752808729976992983259376954042337332017099148318237891368060777558447206427410874586239069373289275272373909442819751045858934796553984793113337147103762753788500061169797977057353150687738596582800167831737578190483124898722767706168748792250249109349)
<class 'rsa.key.PrivateKey'>
True
Decrypted text: Hello World!!! 1234
True
keypair after generation is:
b'f2Qf/Rf3G11PqxI8YYjcQYHQjZwpuQX4B7uUbeE5jmQ='
Original text: Hello World!!! 1234, encrypting using key:
b'f2Qf/Rf3G11PqxI8YYjcQYHQjZwpuQX4B7uUbeE5jmQ='
<class 'bytes'>
Decrypting...mtilNMY525ILx18lOYyiJOUSEHHniXCGO4mjBGScn4w=
Comparing decrypted text %s with original %s ('Hello World!!! 1234', 'Hello World!!! 1234')
True
"""
